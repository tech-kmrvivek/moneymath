<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FIRE Calculator - MoneyMath</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .tab-content {
      opacity: 0;
      transform: translateY(10px);
      transition: all 0.4s ease;
      display: none;
    }
    .tab-content.active {
      display: block;
      opacity: 1;
      transform: translateY(0);
    }
    .tab-btn.active {
      background-color: #2563eb;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 min-h-screen flex flex-col">

  <!-- Header -->
  <div id="include-header"></div>
  <!-- Navigation -->
  <div id="include-nav"></div>

  <!-- Main Calculator -->
  <main class="flex-1 flex flex-col lg:flex-row p-4 sm:p-6 gap-6">
    <!-- Input Panel -->
    <section class="bg-white p-4 sm:p-6 rounded shadow-md w-full lg:w-1/3 space-y-6">
      <h2 class="text-xl font-bold text-blue-600 mb-2">ğŸ”¥ FIRE Calculator</h2>
      <div>
        <label class="block font-semibold mb-1">ğŸ‚ Current Age</label>
        <input type="range" id="currentAge" min="20" max="60" value="30" class="w-full">
        <div class="text-sm text-right">Age: <span id="valCurrentAge">30</span></div>
      </div>
      <div>
        <label class="block font-semibold mb-1">ğŸ Retirement Age</label>
        <input type="range" id="retirementAge" min="30" max="60" value="50" class="w-full">
        <div class="text-sm text-right">Age: <span id="valRetirementAge">50</span></div>
      </div>
      <div>
        <label class="block font-semibold mb-1">â›±ï¸ Coast FIRE Age</label>
        <input id="coastAge" type="range" min="25" max="60" step="1" value="40" class="w-full">
        <div class="text-sm text-right">Age: <span id="valCoastAge">40</span></div>
      </div>
      <div>
        <label class="block font-semibold mb-1">ğŸŒ± Life Expectancy</label>
        <input type="range" id="lifeExpectancy" min="60" max="100" value="85" class="w-full">
        <div class="text-sm text-right">Age: <span id="valLifeExpectancy">85</span></div>
      </div>
      <div>
        <label class="block font-semibold mb-1">ğŸ’° Monthly Expenses Post Retirement (â‚¹) <span class="text-sm italic text-gray-500">(today's value)</span></label>
        <input id="monthlyExpense" type="range" min="10000" max="300000" step="1000" value="40000" class="w-full">
        <div class="text-sm text-right">â‚¹<span id="valMonthlyExpense">40000</span></div>
        <div class="text-xs italic text-gray-500 mt-1 text-right" id="expenseInWords"></div>
      </div>
      <div>
        <label class="block font-semibold mb-1">ğŸ“Š Pre-Retirement Return %</label>
        <input id="returnRate" type="range" min="4" max="20" step="0.5" value="12" class="w-full">
        <div class="text-sm text-right"><span id="valReturnRate">12</span>% annually</div>
      </div>
      <div>
        <label class="block font-semibold mb-1">ğŸ¦ Post-Retirement Return %</label>
        <input id="postReturnRate" type="range" min="1" max="15" step="0.5" value="5" class="w-full">
        <div class="text-sm text-right"><span id="valPostReturnRate">5</span>% annually</div>
      </div>
    </section>

    <!-- Output Panel -->
    <section class="w-full lg:w-2/3 space-y-6">
      <div class="bg-gradient-to-r from-sky-100 to-indigo-100 p-4 rounded shadow-md">
        <h3 class="text-lg font-semibold text-blue-700 mb-2">ğŸ“‹ FIRE Plan Summary</h3>
        <div id="fireSummary" class="grid sm:grid-cols-2 gap-4 text-left font-medium"></div>
      </div>
      <div class="bg-white p-4 rounded shadow-md">
        <h3 class="text-lg font-semibold text-blue-700 mb-2">ğŸ“ FIRE Plan Description</h3>
        <div id="fireDescription" class="space-y-4 text-[15px] leading-relaxed font-medium bg-gradient-to-br from-gray-50 to-white border rounded-lg p-4 shadow-inner">
        </div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <div id="include-footer"></div>

  <script>
    async function loadPartial(id, file) {
      const res = await fetch(file);
      document.getElementById(id).innerHTML = await res.text();
    }

    function formatINR(num) {
      return parseFloat(num).toLocaleString('en-IN');
    }

    function updateFIRE() {
      const currentAge = +document.getElementById('currentAge').value;
      const retirementAge = +document.getElementById('retirementAge').value;
      const lifeExpectancy = +document.getElementById('lifeExpectancy').value;
      const coastAge = +document.getElementById('coastAge').value;
      const monthlyExpense = +document.getElementById('monthlyExpense').value;
      const returnRate = +document.getElementById('returnRate').value;
      const postReturnRate = +document.getElementById('postReturnRate').value;
      const inflation = 0.07;

      document.getElementById('valCurrentAge').textContent = currentAge;
      document.getElementById('valRetirementAge').textContent = retirementAge;
      document.getElementById('valLifeExpectancy').textContent = lifeExpectancy;
      document.getElementById('valCoastAge').textContent = coastAge;
      document.getElementById('valMonthlyExpense').textContent = monthlyExpense;
      document.getElementById('valReturnRate').textContent = returnRate;
      document.getElementById('valPostReturnRate').textContent = postReturnRate;

      const annualExpense = monthlyExpense * 12;
      const retirementYears = lifeExpectancy - retirementAge;
      const yearsToInvest = retirementAge - currentAge;
      const coastInvestYears = coastAge - currentAge;

      const inflatedExpense = annualExpense * Math.pow(1 + inflation, yearsToInvest);
      const fireCorpus = inflatedExpense * ((1 - Math.pow(1 + postReturnRate / 100, -retirementYears)) / (postReturnRate / 100));

      const r = returnRate / 100 / 12;
      const n = yearsToInvest * 12;
      const sip = fireCorpus * r / ((Math.pow(1 + r, n) - 1) * (1 + r));

      let sipCorpus = 0;
      for (let i = 1; i <= n; i++) sipCorpus = (sipCorpus + sip) * (1 + r);

      let coastCorpus = fireCorpus / Math.pow(1 + returnRate / 100, retirementAge - coastAge);

      document.getElementById('fireSummary').innerHTML = `
        <div class="bg-green-100 text-green-800 rounded p-3 shadow font-semibold">
          ğŸ”¥ FIRE Number: â‚¹${formatINR(fireCorpus)}
        </div>
        <div class="bg-yellow-100 text-yellow-800 rounded p-3 shadow font-semibold">
          ğŸ“ˆ SIP Required per Month: â‚¹${formatINR(sip)}
        </div>
        <div class="bg-amber-100 text-amber-800 rounded p-3 shadow font-semibold">
          â›±ï¸ Coast FIRE Age: ${coastAge}
        </div>
        <div class="bg-lime-100 text-lime-800 rounded p-3 shadow font-semibold">
          ğŸ’¼ Coast FIRE Number: â‚¹${formatINR(coastCorpus)}
        </div>`;

      document.getElementById('fireDescription').innerHTML = `
        <ul class="list-disc space-y-2 pl-4">
          <li><strong>ğŸ¯ Annual Retirement Expense (Inflation Adjusted):</strong> <span class="text-blue-900">â‚¹${formatINR(inflatedExpense)}</span></li>
          <li><strong>ğŸ“… Investment Duration:</strong> <span class="text-blue-900">${yearsToInvest} years</span> (Age ${currentAge} to ${retirementAge})</li>
          <li><strong>ğŸ’¼ Total Invested:</strong> <span class="text-blue-900">â‚¹${formatINR(sip * n)}</span> &bull; <strong>Corpus at Retirement:</strong> <span class="text-blue-900">â‚¹${formatINR(sipCorpus)}</span></li>
          <li><strong>ğŸ–ï¸ Monthly Withdrawal:</strong> <span class="text-blue-900">â‚¹${formatINR(monthlyExpense)}</span> (in today's value) â†’ â‚¹<span class="text-blue-900">${formatINR(inflatedExpense / 12)}</span> at Age ${retirementAge} for <span class="text-blue-900">${retirementYears} years</span></li>
          <li><strong>ğŸ“¦ Corpus Left at Age ${lifeExpectancy}:</strong> <span class="text-blue-900">â‚¹0</span> (Fully Depleted)</li>
          <li><strong>â›±ï¸ Coast FIRE Target Age:</strong> <span class="text-blue-900">${coastAge}</span> &bull; <strong>Corpus by then:</strong> <span class="text-blue-900">â‚¹${formatINR(coastCorpus)}</span></li>
        </ul>`;
    }

    ['currentAge', 'retirementAge', 'lifeExpectancy', 'monthlyExpense', 'returnRate', 'postReturnRate', 'coastAge']
      .forEach(id => document.getElementById(id).addEventListener('input', updateFIRE));

    window.addEventListener('DOMContentLoaded', () => {
      loadPartial('include-header', '/components/header.html');
      loadPartial('include-nav', '/components/nav.html');
      loadPartial('include-footer', '/components/footer.html');
      updateFIRE();
    });
  </script>
</body>
</html>
