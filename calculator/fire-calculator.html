<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FIRE Calculator | RupeesWise</title>
  <meta name="description" content="Calculate your FIRE (Financial Independence, Retire Early) and Coast FIRE numbers with our comprehensive calculator. Plan your journey to early retirement.">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" type="image/jpeg" href="/assets/images/fevicon.JPG">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .font-montserrat { font-family: 'Montserrat', sans-serif; }
    /* Custom styles for range sliders */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 8px;
      background: #d1fae5; /* emerald-100 */
      border-radius: 5px;
      outline: none;
      opacity: 0.7;
      transition: opacity .2s;
    }
    input[type="range"]:hover {
      opacity: 1;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #10b981; /* emerald-500 */
      cursor: pointer;
      border-radius: 50%;
      border: 2px solid white;
    }
    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: #10b981; /* emerald-500 */
      cursor: pointer;
      border-radius: 50%;
      border: 2px solid white;
    }
    /* Stylish Tooltip styles */
    .tooltip-container {
        position: relative;
        display: inline-flex;
        align-items: center;
    }
    .tooltip {
        position: absolute;
        bottom: 140%; /* Increased distance */
        left: 50%;
        transform: translateX(-50%) scale(0.95); /* Pop effect */
        background-color: #1f2937; /* gray-800 */
        color: #f9fafb; /* gray-50 */
        text-align: left;
        padding: 10px 14px;
        border-radius: 8px;
        z-index: 50;
        opacity: 0;
        transition: opacity 0.2s ease-in-out, transform 0.2s ease-in-out;
        width: 280px;
        font-size: 0.875rem;
        line-height: 1.5;
        pointer-events: none;
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    }
    /* Tooltip arrow */
    .tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -6px;
        border-width: 6px;
        border-style: solid;
        border-color: #1f2937 transparent transparent transparent;
    }
    .tooltip-container:hover .tooltip {
        opacity: 1;
        transform: translateX(-50%) scale(1);
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col">

  <!-- Placeholder for the Navigation Bar -->
  <div id="include-nav"></div>

  <!-- Main Content -->
  <main class="flex-1 w-full max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
    
    <!-- Page Header -->
    <section class="text-center mb-10">
        <h1 class="text-4xl sm:text-5xl font-extrabold text-emerald-600 dark:text-emerald-400 font-montserrat">FIRE Calculator</h1>
        <p class="mt-3 text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
            Calculate your <span class="font-semibold text-emerald-700 dark:text-emerald-300">F</span>inancial <span class="font-semibold text-emerald-700 dark:text-emerald-300">I</span>ndependence, <span class="font-semibold text-emerald-700 dark:text-emerald-300">R</span>etire <span class="font-semibold text-emerald-700 dark:text-emerald-300">E</span>arly number. Plan your journey to financial freedom and an early retirement.
        </p>
    </section>

    <div class="flex flex-col lg:flex-row gap-8">

      <!-- Left Side: Calculator Inputs -->
      <section class="w-full lg:w-1/3 bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg space-y-6">
        <h2 class="text-2xl font-bold text-gray-800 dark:text-white font-montserrat">Enter Your Details</h2>
        
        <!-- Ages Section -->
        <div class="space-y-6 border-b border-gray-200 dark:border-gray-700 pb-6">
            <h3 class="text-md font-semibold text-gray-500 dark:text-gray-400">Ages & Timeline</h3>
            <div>
              <label for="currentAgeInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Current Age</label>
              <input id="currentAgeInput" type="number" value="30" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="currentAgeSlider" type="range" min="18" max="60" value="30" class="w-full mt-2">
            </div>
    
            <div>
              <label for="retirementAgeInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Target Retirement Age</label>
              <input id="retirementAgeInput" type="number" value="50" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="retirementAgeSlider" type="range" min="30" max="65" value="50" class="w-full mt-2">
            </div>
            
            <div>
              <label for="coastAgeInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Target Coast FIRE Age</label>
              <input id="coastAgeInput" type="number" value="40" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="coastAgeSlider" type="range" min="25" max="60" value="40" class="w-full mt-2">
            </div>
        </div>

        <!-- Financials Section -->
        <div class="space-y-6 pt-2">
            <h3 class="text-md font-semibold text-gray-500 dark:text-gray-400">Financials</h3>
            <div>
              <label for="monthlyExpenseInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Monthly Expenses (Today's Value)</label>
              <div class="mt-1 flex rounded-md shadow-sm">
                <span class="inline-flex items-center px-3 rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-400 text-sm">₹</span>
                <input id="monthlyExpenseInput" type="number" value="50000" class="flex-1 min-w-0 block w-full px-3 py-2 rounded-none rounded-r-md focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              </div>
              <input id="monthlyExpenseSlider" type="range" min="10000" max="500000" step="1000" value="50000" class="w-full mt-2">
              <div id="monthlyExpenseWords" class="text-right text-xs italic text-gray-500 dark:text-gray-400 mt-1"></div>
            </div>
    
            <div>
              <label for="preRetirementRateInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Pre-Retirement Return (%)</label>
              <input id="preRetirementRateInput" type="number" value="12" step="0.5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="preRetirementRateSlider" type="range" min="1" max="25" step="0.5" value="12" class="w-full mt-2">
            </div>
            
            <div>
              <label for="postRetirementRateInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Post-Retirement Return (%)</label>
              <input id="postRetirementRateInput" type="number" value="7" step="0.5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="postRetirementRateSlider" type="range" min="1" max="15" step="0.5" value="7" class="w-full mt-2">
            </div>
            
             <div>
              <label for="inflationRateInput" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Expected Inflation (%)</label>
              <input id="inflationRateInput" type="number" value="6" step="0.5" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white">
              <input id="inflationRateSlider" type="range" min="1" max="10" step="0.5" value="6" class="w-full mt-2">
            </div>
        </div>
      </section>

      <!-- Right Side: Results & Details -->
      <section class="w-full lg:w-2/3 space-y-6">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
          <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4">Your FIRE Plan Summary</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-center">
            <div class="bg-emerald-50 dark:bg-emerald-900/50 p-4 rounded-lg">
                <div class="tooltip-container justify-center">
                    <p class="text-sm text-emerald-600 dark:text-emerald-300 font-medium">FIRE Number</p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2 text-gray-400 cursor-pointer"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <div class="tooltip">The total corpus you need at retirement to be financially independent, based on the 25X rule (4% withdrawal rate).</div>
                </div>
              <p id="fireNumber" class="text-2xl font-bold text-emerald-800 dark:text-emerald-200">₹0</p>
            </div>
            <div class="bg-blue-50 dark:bg-blue-900/50 p-4 rounded-lg">
              <p class="text-sm text-blue-600 dark:text-blue-300 font-medium">Required Monthly SIP (for FIRE)</p>
              <p id="fireSip" class="text-2xl font-bold text-blue-800 dark:text-blue-200">₹0</p>
            </div>
            <div class="bg-yellow-50 dark:bg-yellow-900/50 p-4 rounded-lg">
                <div class="tooltip-container justify-center">
                    <p class="text-sm text-yellow-600 dark:text-yellow-300 font-medium">Coast FIRE Number</p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-2 text-gray-400 cursor-pointer"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                    <div class="tooltip">The amount you need to have invested by your "Coast" age. After this, you only need to cover your expenses, and this corpus will grow to your FIRE number on its own.</div>
                </div>
              <p id="coastFireNumber" class="text-2xl font-bold text-yellow-800 dark:text-yellow-200">₹0</p>
            </div>
            <div class="bg-purple-50 dark:bg-purple-900/50 p-4 rounded-lg">
              <p class="text-sm text-purple-600 dark:text-purple-300 font-medium">Required Monthly SIP (for Coast)</p>
              <p id="coastSip" class="text-2xl font-bold text-purple-800 dark:text-purple-200">₹0</p>
            </div>
          </div>
        </div>
        
        <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow-lg">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">Plan Details</h3>
            <div id="planDetails" class="space-y-4">
                <!-- Details will be generated here -->
            </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Placeholder for the Footer -->
  <div id="include-footer"></div>

  <script>
    // --- DOM Elements ---
    const currentAgeInput = document.getElementById('currentAgeInput');
    const currentAgeSlider = document.getElementById('currentAgeSlider');
    const retirementAgeInput = document.getElementById('retirementAgeInput');
    const retirementAgeSlider = document.getElementById('retirementAgeSlider');
    const coastAgeInput = document.getElementById('coastAgeInput');
    const coastAgeSlider = document.getElementById('coastAgeSlider');
    const monthlyExpenseInput = document.getElementById('monthlyExpenseInput');
    const monthlyExpenseSlider = document.getElementById('monthlyExpenseSlider');
    const monthlyExpenseWords = document.getElementById('monthlyExpenseWords');
    const preRetirementRateInput = document.getElementById('preRetirementRateInput');
    const preRetirementRateSlider = document.getElementById('preRetirementRateSlider');
    const postRetirementRateInput = document.getElementById('postRetirementRateInput');
    const postRetirementRateSlider = document.getElementById('postRetirementRateSlider');
    const inflationRateInput = document.getElementById('inflationRateInput');
    const inflationRateSlider = document.getElementById('inflationRateSlider');

    // --- Output Elements ---
    const fireNumberEl = document.getElementById('fireNumber');
    const fireSipEl = document.getElementById('fireSip');
    const coastFireNumberEl = document.getElementById('coastFireNumber');
    const coastSipEl = document.getElementById('coastSip');
    const planDetailsEl = document.getElementById('planDetails');

    // --- Utility Functions ---
    function formatINR(num) {
      if (num >= 10000000) return `₹${(num / 10000000).toFixed(2)} Cr`;
      if (num >= 100000) return `₹${(num / 100000).toFixed(2)} L`;
      return `₹${num.toLocaleString('en-IN')}`;
    }
    
    function numberToWords(num) {
        const a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
        const b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
        const numStr = num.toString();
        if (num < 0) return 'minus ' + numberToWords(-num);
        if (num === 0) return 'zero';
        if (num < 20) return a[num];
        if (numStr.length === 2) return b[numStr[0]] + (numStr[1] === '0' ? '' : ' ' + a[numStr[1]]);
        if (numStr.length === 3) return a[numStr[0]] + ' hundred' + (num % 100 === 0 ? '' : ' and ' + numberToWords(num % 100));
        if (numStr.length === 4 || numStr.length === 5) return numberToWords(Math.floor(num / 1000)) + ' thousand' + (num % 1000 !== 0 ? ' ' + numberToWords(num % 1000) : '');
        if (numStr.length === 6 || numStr.length === 7) return numberToWords(Math.floor(num / 100000)) + ' lakh' + (num % 100000 !== 0 ? ' ' + numberToWords(num % 100000) : '');
        if (numStr.length > 7) return numberToWords(Math.floor(num / 10000000)) + ' crore' + (num % 10000000 !== 0 ? ' ' + numberToWords(num % 10000000) : '');
        return '';
    }

    // --- Calculation Logic ---
    function calculateFIRE() {
      const currentAge = parseInt(currentAgeInput.value);
      const retirementAge = parseInt(retirementAgeInput.value);
      const coastAge = parseInt(coastAgeInput.value);
      const monthlyExpense = parseFloat(monthlyExpenseInput.value);
      const preRate = parseFloat(preRetirementRateInput.value) / 100;
      const postRate = parseFloat(postRetirementRateInput.value) / 100;
      const inflation = parseFloat(inflationRateInput.value) / 100;

      // --- Calculations ---
      const yearsToRetire = retirementAge - currentAge;
      const inflatedAnnualExpense = (monthlyExpense * 12) * Math.pow(1 + inflation, yearsToRetire);
      
      const fireCorpus = inflatedAnnualExpense * 25;

      const monthlyPreRate = preRate / 12;
      const n_fire = yearsToRetire * 12;
      const fireSip = n_fire > 0 ? (fireCorpus * monthlyPreRate) / (Math.pow(1 + monthlyPreRate, n_fire) - 1) : 0;
      const fireTotalInvested = fireSip * n_fire;
      
      const yearsToCoast = coastAge - currentAge;
      const coastingPeriod = retirementAge - coastAge;
      const coastCorpusTarget = coastingPeriod > 0 ? fireCorpus / Math.pow(1 + preRate, coastingPeriod) : fireCorpus;

      const n_coast = yearsToCoast * 12;
      const coastSip = n_coast > 0 ? (coastCorpusTarget * monthlyPreRate) / (Math.pow(1 + monthlyPreRate, n_coast) - 1) : 0;
      const coastTotalInvested = coastSip * n_coast;

      // --- Update UI ---
      fireNumberEl.textContent = formatINR(fireCorpus);
      fireSipEl.textContent = formatINR(fireSip);
      coastFireNumberEl.textContent = formatINR(coastCorpusTarget);
      coastSipEl.textContent = formatINR(coastSip);
      monthlyExpenseWords.textContent = numberToWords(monthlyExpense).split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') + ' Rupees';
      
      planDetailsEl.innerHTML = `
        <div class="space-y-2">
            <h4 class="font-semibold text-md text-emerald-700 dark:text-emerald-400">Standard FIRE Plan</h4>
            <div class="text-sm grid grid-cols-2 gap-2 border-t border-gray-200 dark:border-gray-700 pt-2">
                <span class="text-gray-600 dark:text-gray-400">Retirement Expenses (Annual):</span>
                <span class="font-medium text-right">${formatINR(inflatedAnnualExpense)}</span>
                <span class="text-gray-600 dark:text-gray-400">Years to Invest:</span>
                <span class="font-medium text-right">${yearsToRetire} Years</span>
                <span class="text-gray-600 dark:text-gray-400">Total Amount Invested:</span>
                <span class="font-medium text-right">${formatINR(fireTotalInvested)}</span>
            </div>
        </div>
        <div class="space-y-2">
            <h4 class="font-semibold text-md text-yellow-600 dark:text-yellow-400">Coast FIRE Plan</h4>
            <div class="text-sm grid grid-cols-2 gap-2 border-t border-gray-200 dark:border-gray-700 pt-2">
                <span class="text-gray-600 dark:text-gray-400">Target Coast Age:</span>
                <span class="font-medium text-right">${coastAge}</span>
                <span class="text-gray-600 dark:text-gray-400">Years to Invest:</span>
                <span class="font-medium text-right">${yearsToCoast} Years</span>
                <span class="text-gray-600 dark:text-gray-400">Total Amount Invested:</span>
                <span class="font-medium text-right">${formatINR(coastTotalInvested)}</span>
                <span class="text-gray-600 dark:text-gray-400">Coasting Period:</span>
                <span class="font-medium text-right">${coastingPeriod} Years</span>
            </div>
        </div>
      `;
    }

    // --- Event Listeners and Initializer ---
    async function loadPartial(id, file) {
      try {
        const response = await fetch(file);
        if (!response.ok) throw new Error(`Failed to load ${file}: ${response.status}`);
        const text = await response.text();
        const element = document.getElementById(id);
        if (element) {
          element.innerHTML = text;
          Array.from(element.querySelectorAll("script")).forEach(oldScript => {
            const newScript = document.createElement("script");
            Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
            newScript.appendChild(document.createTextNode(oldScript.innerHTML));
            oldScript.parentNode.replaceChild(newScript, oldScript);
          });
        }
      } catch (error) {
        console.error(`Error loading partial: ${error}`);
      }
    }
    
    function setupEventListeners() {
        const sync = (input, slider) => {
            slider.addEventListener('input', () => {
                input.value = slider.value;
                calculateFIRE();
            });
            input.addEventListener('input', () => {
                slider.value = input.value;
                calculateFIRE();
            });
        };

        sync(currentAgeInput, currentAgeSlider);
        sync(retirementAgeInput, retirementAgeSlider);
        sync(coastAgeInput, coastAgeSlider);
        sync(monthlyExpenseInput, monthlyExpenseSlider);
        sync(preRetirementRateInput, preRetirementRateSlider);
        sync(postRetirementRateInput, postRetirementRateSlider);
        sync(inflationRateInput, inflationRateSlider);
    }
    
    document.addEventListener('DOMContentLoaded', async () => {
      await Promise.all([
        loadPartial("include-nav", "../components/nav.html"),
        loadPartial("include-footer", "../components/footer.html")
      ]);
      setupEventListeners();
      calculateFIRE(); // Initial calculation
    });
  </script>
</body>
</html>
