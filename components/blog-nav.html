<!-- /components/blog-nav -->
<!-- This is the redesigned, stylish side navigation for your blog pages. -->

<aside class="w-full sm:w-72 bg-white dark:bg-gray-800 shadow-lg rounded-2xl p-4 border border-gray-200 dark:border-gray-700">
  <button id="blog-nav-toggle" class="w-full flex items-center justify-between text-lg font-bold text-emerald-800 dark:text-emerald-300 mb-2 px-2 py-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
    <span class="flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-500"><path d="M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v16a2 2 0 0 0-2 2"></path><path d="M16 2v20"></path></svg>
      <span>All Topics</span>
    </span>
    <svg id="blog-nav-arrow" class="w-5 h-5 transition-transform transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  
  <div id="blog-links-container" class="transition-all duration-300 ease-in-out overflow-hidden">
      <ul class="space-y-1 pt-2 border-t border-gray-100 dark:border-gray-700" id="blogLinks">
        <!-- Links will be populated and styled by the script -->
        <li><a href="/blogs/what-is-sip" class="blog-link">What is SIP and Why Every Investor Should Know It</a></li>
        <li><a href="/blogs/build_wealth_with_sip" class="blog-link">How SIP Can Build Wealth Over Time</a></li>
        <li><a href="/blogs/lumpsum_vs_sip" class="blog-link">Lumpsum vs. SIP: Which is Better?</a></li>
        <li><a href="/blogs/swp" class="blog-link">Understanding SWP: Systematic Withdrawal Plan</a></li>
        <li><a href="/blogs/fire-retire-early" class="blog-link">FIRE: Retire Early With Smart Planning</a></li>
        <li><a href="/blogs/delaying-costs-more" class="blog-link">Why Delaying Investment Costs You More</a></li>
        <li><a href="/blogs/compound-interest-explained" class="blog-link">How Compound Interest Works (with Examples)</a></li>
        <li><a href="/blogs/mutual-fund-vs-fd" class="blog-link">Mutual Funds vs. Fixed Deposits</a></li>
        <li><a href="/blogs/salary-saving-rule" class="blog-link">How Much Should I Save From My Salary?</a></li>
        <li><a href="/blogs/retire-by-40-india" class="blog-link">How to Retire by 40: A Practical Case Study</a></li>
        <li><a href="/blogs/family-fire-planning" class="blog-link">FIRE Planning for Families</a></li>
        <li><a href="/blogs/1cr-with-5000-sip" class="blog-link">Plan ₹1 Cr with Just ₹5000/month SIP</a></li>
        <li><a href="/blogs/sip-for-1cr-in-15-years" class="blog-link">SIP Needed for ₹1 Cr in 15 Years</a></li>
      </ul>
  </div>
</aside>

<script>
  (() => {
    const toggleButton = document.getElementById("blog-nav-toggle");
    const arrow = document.getElementById("blog-nav-arrow");
    const linksContainer = document.getElementById("blog-links-container");
    const linksList = document.getElementById("blogLinks");

    if (!toggleButton || !linksContainer || !linksList) return;

    // Function to style the links
    const styleLinks = () => {
        const links = linksList.querySelectorAll("a.blog-link");
        const currentPath = window.location.pathname;
        const storageKey = 'rupeeswise_read_blogs';
        
        let readBlogs = [];
        try {
          const stored = localStorage.getItem(storageKey);
          if (stored) readBlogs = JSON.parse(stored);
        } catch (e) {
          console.error("Error parsing read blogs from localStorage", e);
        }

        links.forEach(link => {
          const linkPath = link.getAttribute("href");
          const isRead = readBlogs.includes(linkPath);
          const isActive = linkPath === currentPath;

          link.className = 'blog-link group flex items-center justify-between px-3 py-2.5 rounded-lg transition-all duration-200';
          
          let iconHTML = '';
          if (isActive) {
            link.classList.add('bg-emerald-600', 'text-white', 'font-semibold', 'shadow-md');
            iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-100"><path d="m9 18 6-6-6-6"/></svg>`;
          } else {
            link.classList.add('text-gray-600', 'dark:text-gray-300', 'hover:bg-emerald-50', 'dark:hover:bg-gray-700', 'hover:text-emerald-700', 'dark:hover:text-emerald-400');
            if (isRead) {
              link.classList.add('opacity-80');
              iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-500"><path d="M20 6 9 17l-5-5"/></svg>`;
            } else {
              iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-0 group-hover:opacity-100 transition-opacity duration-200"><path d="m9 18 6-6-6-6"/></svg>`;
            }
          }
          
          const originalText = link.textContent;
          link.innerHTML = `<span>${originalText}</span>${iconHTML}`;
        });
    };

    // Toggle functionality
    toggleButton.addEventListener('click', () => {
        const isExpanded = linksContainer.style.maxHeight && linksContainer.style.maxHeight !== "0px";
        if (isExpanded) {
            linksContainer.style.maxHeight = null;
            arrow.classList.remove('rotate-180');
        } else {
            linksContainer.style.maxHeight = linksContainer.scrollHeight + "px";
            arrow.classList.add('rotate-180');
        }
    });

    // Initial setup
    styleLinks();
    // Start expanded by default
    linksContainer.style.maxHeight = linksContainer.scrollHeight + "px";
    arrow.classList.add('rotate-180');
  })();
</script>
