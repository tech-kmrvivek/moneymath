<!-- /components/blog-nav -->
<!-- This is the redesigned, stylish side navigation for your blog pages. -->

<aside class="w-full sm:w-72 bg-white dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200/80 dark:border-gray-700/60 shadow-xl rounded-2xl p-4">
  <button id="blog-nav-toggle" class="w-full flex items-center justify-between text-lg font-bold text-gray-800 dark:text-white mb-4 px-3 py-2 rounded-lg transition-colors">
    <span class="flex items-center gap-3">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-500"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
      <span>Blog Topics</span>
    </span>
    <svg id="blog-nav-arrow" class="w-5 h-5 transition-transform transform text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
  </button>
  
  <div id="blog-links-container" class="transition-all duration-500 ease-in-out overflow-hidden">
      <ul class="space-y-1.5" id="blogLinks">
        <!-- Links will be populated and styled by the script -->
        <li><a href="/blogs/what-is-sip" class="blog-link">What is SIP and Why Every Investor Should Know It</a></li>
        <li><a href="/blogs/build_wealth_with_sip" class="blog-link">How SIP Can Build Wealth Over Time</a></li>
        <li><a href="/blogs/lumpsum_vs_sip" class="blog-link">Lumpsum vs. SIP: Which is Better?</a></li>
        <li><a href="/blogs/swp" class="blog-link">Understanding SWP: Systematic Withdrawal Plan</a></li>
        <li><a href="/blogs/fire-retire-early" class="blog-link">FIRE: Retire Early With Smart Planning</a></li>
        <li><a href="/blogs/delaying-costs-more" class="blog-link">Why Delaying Investment Costs You More</a></li>
        <li><a href="/blogs/compound-interest-explained" class="blog-link">How Compound Interest Works (with Examples)</a></li>
        <li><a href="/blogs/mutual-fund-vs-fd" class="blog-link">Mutual Funds vs. Fixed Deposits</a></li>
        <li><a href="/blogs/salary-saving-rule" class="blog-link">How Much Should I Save From My Salary?</a></li>
        <li><a href="/blogs/retire-by-40-india" class="blog-link">How to Retire by 40: A Practical Case Study</a></li>
        <li><a href="/blogs/family-fire-planning" class="blog-link">FIRE Planning for Families</a></li>
        <li><a href="/blogs/1cr-with-5000-sip" class="blog-link">Plan ₹1 Cr with Just ₹5000/month SIP</a></li>
        <li><a href="/blogs/sip-for-1cr-in-15-years" class="blog-link">SIP Needed for ₹1 Cr in 15 Years</a></li>
      </ul>
  </div>
</aside>

<script>
  (() => {
    const toggleButton = document.getElementById("blog-nav-toggle");
    const arrow = document.getElementById("blog-nav-arrow");
    const linksContainer = document.getElementById("blog-links-container");
    const linksList = document.getElementById("blogLinks");

    if (!toggleButton || !linksContainer || !linksList) return;

    // Function to style the links
    const styleLinks = () => {
        const links = linksList.querySelectorAll("a.blog-link");
        const currentPath = window.location.pathname;
        const storageKey = 'rupeeswise_read_blogs';
        
        let readBlogs = [];
        try {
          const stored = localStorage.getItem(storageKey);
          if (stored) readBlogs = JSON.parse(stored);
        } catch (e) {
          console.error("Error parsing read blogs from localStorage", e);
        }

        links.forEach(link => {
          const linkPath = link.getAttribute("href");
          const isRead = readBlogs.includes(linkPath);
          const isActive = linkPath === currentPath;

          // Reset classes
          link.className = 'blog-link group flex items-center justify-between text-sm px-3 py-2.5 rounded-lg transition-all duration-200 font-medium';
          
          let iconHTML = '';
          if (isActive) {
            link.classList.add('bg-emerald-600', 'text-white', 'font-semibold', 'shadow-lg', 'shadow-emerald-500/30');
            iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="opacity-100"><path d="m9 18 6-6-6-6"/></svg>`;
          } else {
            link.classList.add('text-gray-500', 'dark:text-gray-400', 'hover:bg-gray-100', 'dark:hover:bg-gray-700/50', 'hover:text-gray-900', 'dark:hover:text-white');
            if (isRead) {
              link.classList.add('text-emerald-800', 'dark:text-emerald-500');
              iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-500"><path d="M20 6 9 17l-5-5"/></svg>`;
            } else {
              iconHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-gray-400"><path d="m9 18 6-6-6-6"/></svg>`;
            }
          }
          
          const originalText = link.textContent;
          link.innerHTML = `<span class="truncate pr-2">${originalText}</span><span class="flex-shrink-0">${iconHTML}</span>`;
        });
    };

    // Toggle functionality
    toggleButton.addEventListener('click', () => {
        const isExpanded = linksContainer.style.maxHeight && linksContainer.style.maxHeight !== "0px";
        if (isExpanded) {
            linksContainer.style.maxHeight = "0px";
            arrow.classList.remove('rotate-180');
        } else {
            linksContainer.style.maxHeight = linksContainer.scrollHeight + "px";
            arrow.classList.add('rotate-180');
        }
    });

    // Initial setup
    styleLinks();
    
    // Start expanded by default and handle resize
    const setInitialHeight = () => {
        if (window.innerWidth < 640) { // sm breakpoint
            linksContainer.style.maxHeight = "0px";
            arrow.classList.remove('rotate-180');
        } else {
            linksContainer.style.maxHeight = linksContainer.scrollHeight + "px";
            arrow.classList.add('rotate-180');
        }
    };
    
    setInitialHeight();
    window.addEventListener('resize', () => {
        // Only adjust if it was previously expanded
        if (linksContainer.style.maxHeight !== "0px") {
           linksContainer.style.maxHeight = linksContainer.scrollHeight + "px";
        }
    });
  })();
</script>
